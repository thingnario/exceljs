{"version":3,"sources":["../../../lib/doc/cell.js"],"names":["colCache","require","Enums","slideFormula","Cell","module","exports","row","column","address","Error","_row","_column","validateAddress","_address","_value","Value","create","Types","Null","style","_mergeStyle","_mergeCount","ValueType","prototype","worksheet","workbook","destroy","numFmt","value","font","alignment","border","fill","rowStyle","colStyle","number","col","$col$row","letter","type","effectiveType","toCsvString","addMergeRef","releaseMergeRef","isMerged","Merge","merge","master","release","unmerge","isMergedTo","isHyperlink","Hyperlink","hyperlink","v","getType","text","toString","_upgradeToHyperlink","String","formula","result","formulaType","fullAddress","sheetName","name","names","definedNames","getNamesEx","self","removeAllNames","forEach","addEx","addName","removeName","removeEx","_dataValidations","dataValidations","dataValidation","find","add","model","NullValue","cell","NumberValue","Number","StringValue","replace","RichTextValue","richText","map","t","join","RichText","DateValue","Date","toISOString","HyperlinkValue","undefined","MergeValue","_master","FormulaValue","Formula","sharedFormula","validate","dependencies","ranges","match","cells","_getTranslatedFormula","FormulaType","Master","Shared","None","_translatedFormula","findCell","SharedStringValue","SharedString","BooleanValue","Boolean","ErrorValue","error","JSONValue","JSON","stringify","rawValue","sharedString","types","f","reduce","p","T"],"mappings":"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","file":"cell.js","sourcesContent":["/**\n * Copyright (c) 2014-2017 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar colCache = require('../utils/col-cache');\nvar Enums = require('./enums');\nvar { slideFormula } = require('../utils/shared-formula');\n\n// Cell requirements\n//  Operate inside a worksheet\n//  Store and retrieve a value with a range of types: text, number, date, hyperlink, reference, formula, etc.\n//  Manage/use and manipulate cell format either as local to cell or inherited from column or row.\n\nvar Cell = module.exports = function(row, column, address) {\n  if (!row || !column) {\n    throw new Error('A Cell needs a Row');\n  }\n\n  this._row = row;\n  this._column = column;\n\n  colCache.validateAddress(address);\n  this._address = address;\n\n  // TODO: lazy evaluation of this._value\n  this._value = Value.create(Cell.Types.Null, this);\n\n  this.style = this._mergeStyle(row.style, column.style, {});\n\n  this._mergeCount = 0;\n};\n\nCell.Types = Enums.ValueType;\n\nCell.prototype = {\n\n  get worksheet() {\n    return this._row.worksheet;\n  },\n  get workbook() {\n    return this._row.worksheet.workbook;\n  },\n\n  // help GC by removing cyclic (and other) references\n  destroy: function() {\n    delete this.style;\n    delete this._value;\n    delete this._row;\n    delete this._column;\n    delete this._address;\n  },\n\n  // =========================================================================\n  // Styles stuff\n  get numFmt() {\n    return this.style.numFmt;\n  },\n  set numFmt(value) {\n    this.style.numFmt = value;\n  },\n  get font() {\n    return this.style.font;\n  },\n  set font(value) {\n    this.style.font = value;\n  },\n  get alignment() {\n    return this.style.alignment;\n  },\n  set alignment(value) {\n    this.style.alignment = value;\n  },\n  get border() {\n    return this.style.border;\n  },\n  set border(value) {\n    this.style.border = value;\n  },\n  get fill() {\n    return this.style.fill;\n  },\n  set fill(value) {\n    this.style.fill = value;\n  },\n\n  _mergeStyle: function(rowStyle, colStyle, style) {\n    var numFmt = (rowStyle && rowStyle.numFmt) || (colStyle && colStyle.numFmt);\n    if (numFmt) style.numFmt = numFmt;\n\n    var font = (rowStyle && rowStyle.font) || (colStyle && colStyle.font);\n    if (font) style.font = font;\n\n    var alignment = (rowStyle && rowStyle.alignment) || (colStyle && colStyle.alignment);\n    if (alignment) style.alignment = alignment;\n\n    var border = (rowStyle && rowStyle.border) || (colStyle && colStyle.border);\n    if (border) style.border = border;\n\n    var fill = (rowStyle && rowStyle.fill) || (colStyle && colStyle.fill);\n    if (fill) style.fill = fill;\n\n    return style;\n  },\n\n  // =========================================================================\n  // return the address for this cell\n  get address() {\n    return this._address;\n  },\n\n  get row() {\n    return this._row.number;\n  },\n  get col() {\n    return this._column.number;\n  },\n\n  get $col$row() {\n    return '$' + this._column.letter + '$' + this.row;\n  },\n\n\n  // =========================================================================\n  // Value stuff\n\n  get type() {\n    return this._value.type;\n  },\n\n  get effectiveType() {\n    return this._value.effectiveType;\n  },\n\n  toCsvString: function() {\n    return this._value.toCsvString();\n  },\n\n  // =========================================================================\n  // Merge stuff\n\n  addMergeRef: function() {\n    this._mergeCount++;\n  },\n  releaseMergeRef: function() {\n    this._mergeCount--;\n  },\n  get isMerged() {\n    return (this._mergeCount > 0) || (this.type === Cell.Types.Merge);\n  },\n  merge: function(master) {\n    this._value.release();\n    this._value = Value.create(Cell.Types.Merge, this, master);\n    this.style = master.style;\n  },\n  unmerge: function() {\n    if (this.type === Cell.Types.Merge) {\n      this._value.release();\n      this._value = Value.create(Cell.Types.Null, this);\n      this.style = this._mergeStyle(this._row.style, this._column.style, {});\n    }\n  },\n  isMergedTo: function(master) {\n    if (this._value.type !== Cell.Types.Merge) return false;\n    return this._value.isMergedTo(master);\n  },\n  get master() {\n    if (this.type === Cell.Types.Merge) {\n      return this._value.master;\n    }\n    return this; // an unmerged cell is its own master\n  },\n\n  get isHyperlink() {\n    return this._value.type === Cell.Types.Hyperlink;\n  },\n  get hyperlink() {\n    return this._value.hyperlink;\n  },\n\n  // return the value\n  get value() {\n    return this._value.value;\n  },\n  // set the value - can be number, string or raw\n  set value(v) {\n    // special case - merge cells set their master's value\n    if (this.type === Cell.Types.Merge) {\n      this._value.master.value = v;\n      return;\n    }\n\n    this._value.release();\n\n    // assign value\n    this._value = Value.create(Value.getType(v), this, v);\n  },\n  get text() {\n    return this._value.toString();\n  },\n  toString: function() {\n    return this.text;\n  },\n\n  _upgradeToHyperlink: function(hyperlink) {\n    // if this cell is a string, turn it into a Hyperlink\n    if (this.type === Cell.Types.String) {\n      this._value = Value.create(Cell.Types.Hyperlink, this, {\n        text: this._value.value,\n        hyperlink: hyperlink\n      });\n    }\n  },\n\n  // =========================================================================\n  // Formula stuff\n  get formula() {\n    return this._value.formula;\n  },\n  get result() {\n    return this._value.result;\n  },\n  get formulaType() {\n    return this._value.formulaType;\n  },\n\n  // =========================================================================\n  // Name stuff\n  get fullAddress() {\n    var worksheet = this._row.worksheet;\n    return {\n      sheetName: worksheet.name,\n      address: this.address,\n      row: this.row,\n      col: this.col\n    };\n  },\n  get name() {\n    return this.names[0];\n  },\n  set name(value) {\n    this.names = [value];\n  },\n  get names() {\n    return this.workbook.definedNames.getNamesEx(this.fullAddress);\n  },\n  set names(value) {\n    var self = this;\n    var definedNames = this.workbook.definedNames;\n    this.workbook.definedNames.removeAllNames(self.fullAddress);\n    value.forEach(function(name) {\n      definedNames.addEx(self.fullAddress, name);\n    });\n  },\n  addName: function(name) {\n    this.workbook.definedNames.addEx(this.fullAddress, name);\n  },\n  removeName: function(name) {\n    this.workbook.definedNames.removeEx(this.fullAddress, name);\n  },\n  removeAllNames: function() {\n    this.workbook.definedNames.removeAllNames(this.fullAddress);\n  },\n\n  // =========================================================================\n  // Data Validation stuff\n  get _dataValidations() {\n    return this.worksheet.dataValidations;\n  },\n\n  get dataValidation() {\n    return this._dataValidations.find(this.address);\n  },\n\n  set dataValidation(value) {\n    this._dataValidations.add(this.address, value);\n  },\n\n  // =========================================================================\n  // Model stuff\n\n  get model() {\n    var model = this._value.model;\n    model.style = this.style;\n    return model;\n  },\n  set model(value) {\n    this._value.release();\n    this._value = Value.create(value.type, this);\n    this._value.model = value;\n    if (value.style) {\n      this.style = value.style;\n    } else {\n      this.style = {};\n    }\n  }\n};\n\n// =============================================================================\n// Internal Value Types\n\nvar NullValue = function(cell) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Null\n  };\n};\nNullValue.prototype = {\n  get value() {\n    return null;\n  },\n  set value(value) {\n    // nothing to do\n  },\n  get type() {\n    return Cell.Types.Null;\n  },\n  get effectiveType() {\n    return Cell.Types.Null;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return '';\n  },\n  release: function() {\n  },\n  toString: function() {\n    return '';\n  }\n};\n\nvar NumberValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Number,\n    value: value\n  };\n};\nNumberValue.prototype = {\n  get value() {\n    return this.model.value;\n  },\n  set value(value) {\n    this.model.value = value;\n  },\n  get type() {\n    return Cell.Types.Number;\n  },\n  get effectiveType() {\n    return Cell.Types.Number;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return '' + this.model.value;\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.value.toString();\n  }\n};\n\nvar StringValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.String,\n    value: value\n  };\n};\nStringValue.prototype = {\n  get value() {\n    return this.model.value;\n  },\n  set value(value) {\n    this.model.value = value;\n  },\n  get type() {\n    return Cell.Types.String;\n  },\n  get effectiveType() {\n    return Cell.Types.String;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return '\"' + this.model.value.replace(/\"/g, '\"\"') + '\"';\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.value;\n  }\n};\n\nvar RichTextValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.String,\n    value: value\n  };\n};\nRichTextValue.prototype = {\n  get value() {\n    return this.model.value;\n  },\n  set value(value) {\n    this.model.value = value;\n  },\n  toString: function() {\n    return this.model.value.richText.map(function(t) {\n      return t.text;\n    }).join('');\n  },\n  get type() {\n    return Cell.Types.RichText;\n  },\n  get effectiveType() {\n    return Cell.Types.RichText;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return '\"' + this.text.replace(/\"/g, '\"\"') + '\"';\n  },\n  release: function() {\n  }\n};\n\nvar DateValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Date,\n    value: value\n  };\n};\nDateValue.prototype = {\n  get value() {\n    return this.model.value;\n  },\n  set value(value) {\n    this.model.value = value;\n  },\n  get type() {\n    return Cell.Types.Date;\n  },\n  get effectiveType() {\n    return Cell.Types.Date;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return this.model.value.toISOString();\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.value.toString();\n  }\n};\n\nvar HyperlinkValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Hyperlink,\n    text: value ? value.text : undefined,\n    hyperlink: value ? value.hyperlink : undefined\n  };\n};\nHyperlinkValue.prototype = {\n  get value() {\n    return {\n      text: this.model.text,\n      hyperlink: this.model.hyperlink\n    };\n  },\n  set value(value) {\n    this.model.text = value.text;\n    this.model.hyperlink = value.hyperlink;\n  },\n\n  get text() {\n    return this.model.text;\n  },\n  set text(value) {\n    this.model.text = value;\n  },\n  get hyperlink() {\n    return this.model.hyperlink;\n  },\n  set hyperlink(value) {\n    this.model.hyperlink = value;\n  },\n  get type() {\n    return Cell.Types.Hyperlink;\n  },\n  get effectiveType() {\n    return Cell.Types.Hyperlink;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return this.model.hyperlink;\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.text;\n  }\n};\n\nvar MergeValue = function(cell, master) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Merge,\n    master: master ? master.address : undefined\n  };\n  this._master = master;\n  if (master) {\n    master.addMergeRef();\n  }\n};\nMergeValue.prototype = {\n  get value() {\n    return this._master.value;\n  },\n  set value(value) {\n    if (value instanceof Cell) {\n      if (this._master) {\n        this._master.releaseMergeRef();\n      }\n      value.addMergeRef();\n      this._master = value;\n    } else {\n      this._master.value = value;\n    }\n  },\n\n  isMergedTo: function(master) {\n    return master === this._master;\n  },\n  get master() {\n    return this._master;\n  },\n  get type() {\n    return Cell.Types.Merge;\n  },\n  get effectiveType() {\n    return this._master.effectiveType;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return '';\n  },\n  release: function() {\n    this._master.releaseMergeRef();\n  },\n  toString: function() {\n    return this.value.toString();\n  }\n};\n\nvar FormulaValue = function(cell, value) {\n  this.cell = cell;\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Formula,\n    formula: value ? value.formula : undefined,\n    sharedFormula: value ? value.sharedFormula : undefined,\n    result: value ? value.result : undefined\n  };\n};\nFormulaValue.prototype = {\n  get value() {\n    return this.model.formula ? {\n      formula: this.model.formula,\n      result: this.model.result,\n    } : {\n      sharedFormula: this.model.sharedFormula,\n      result: this.model.result,\n    };\n  },\n  set value(value) {\n    this.model.formula = value.formula;\n    this.model.sharedFormula = value.sharedFormula;\n    this.model.result = value.result;\n  },\n  validate: function(value) {\n    switch (Value.getType(value)) {\n      case Cell.Types.Null:\n      case Cell.Types.String:\n      case Cell.Types.Number:\n      case Cell.Types.Date:\n        break;\n      case Cell.Types.Hyperlink:\n      case Cell.Types.Formula:\n      default:\n        throw new Error('Cannot process that type of result value');\n    }\n  },\n  get dependencies() {\n    // find all the ranges and cells mentioned in the formula\n    var ranges = this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}:[A-Z]{1,3}\\d{1,4}/g);\n    var cells = this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}:[A-Z]{1,3}\\d{1,4}/g, '')\n      .match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}/g);\n    return {\n      ranges: ranges,\n      cells: cells\n    };\n  },\n  get formula() {\n    return this.model.formula ||\n      this._getTranslatedFormula();\n  },\n  set formula(value) {\n    this.model.formula = value;\n  },\n  get formulaType() {\n    if (this.model.formula) {\n      return Enums.FormulaType.Master;\n    }\n    if (this.model.sharedFormula) {\n      return Enums.FormulaType.Shared;\n    }\n    return Enums.FormulaType.None;\n  },\n  get result() {\n    return this.model.result;\n  },\n  set result(value) {\n    this.model.result = value;\n  },\n  get type() {\n    return Cell.Types.Formula;\n  },\n  get effectiveType() {\n    var v = this.model.result;\n    if ((v === null) || (v === undefined)) {\n      return Enums.ValueType.Null;\n    } else if ((v instanceof String) || (typeof v === 'string')) {\n      return Enums.ValueType.String;\n    } else if (typeof v === 'number') {\n      return Enums.ValueType.Number;\n    } else if (v instanceof Date) {\n      return Enums.ValueType.Date;\n    } else if (v.text && v.hyperlink) {\n      return Enums.ValueType.Hyperlink;\n    } else if (v.formula) {\n      return Enums.ValueType.Formula;\n    }\n\n    return Enums.ValueType.Null;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  _getTranslatedFormula() {\n    if (!this._translatedFormula && this.model.sharedFormula) {\n      var worksheet = this.cell.worksheet;\n      var master = worksheet.findCell(this.model.sharedFormula);\n      this._translatedFormula = master &&\n        slideFormula(master.formula, master.address, this.model.address);\n    }\n    return this._translatedFormula;\n  },\n  toCsvString: function() {\n    return '' + (this.model.result || '');\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.result ? this.model.result.toString() : '';\n  }\n};\n\nvar SharedStringValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.SharedString,\n    value: value\n  };\n};\nSharedStringValue.prototype = {\n  get value() {\n    return this.model.value;\n  },\n  set value(value) {\n    this.model.value = value;\n  },\n  get type() {\n    return Cell.Types.SharedString;\n  },\n  get effectiveType() {\n    return Cell.Types.SharedString;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return '' + this.model.value;\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.value.toString();\n  }\n};\n\nvar BooleanValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Boolean,\n    value: value\n  };\n};\nBooleanValue.prototype = {\n  get value() {\n    return this.model.value;\n  },\n  set value(value) {\n    this.model.value = value;\n  },\n  get type() {\n    return Cell.Types.Boolean;\n  },\n  get effectiveType() {\n    return Cell.Types.Boolean;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return this.model.value ? 1 : 0;\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.value.toString();\n  }\n};\n\nvar ErrorValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.Error,\n    value: value\n  };\n};\nErrorValue.prototype = {\n  get value() {\n    return this.model.value;\n  },\n  set value(value) {\n    this.model.value = value;\n  },\n  get type() {\n    return Cell.Types.Error;\n  },\n  get effectiveType() {\n    return Cell.Types.Error;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return this.toString();\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.value.error.toString();\n  }\n};\n\nvar JSONValue = function(cell, value) {\n  this.model = {\n    address: cell.address,\n    type: Cell.Types.String,\n    value: JSON.stringify(value),\n    rawValue: value\n  };\n};\nJSONValue.prototype = {\n  get value() {\n    return this.model.rawValue;\n  },\n  set value(value) {\n    this.model.rawValue = value;\n    this.model.value = JSON.stringify(value);\n  },\n  get type() {\n    return Cell.Types.String;\n  },\n  get effectiveType() {\n    return Cell.Types.String;\n  },\n  get address() {\n    return this.model.address;\n  },\n  set address(value) {\n    this.model.address = value;\n  },\n  toCsvString: function() {\n    return this.model.value;\n  },\n  release: function() {\n  },\n  toString: function() {\n    return this.model.value;\n  }\n};\n\n// Value is a place to hold common static Value type functions\nvar Value = {\n  getType: function(value) {\n    if ((value === null) || (value === undefined)) {\n      return Cell.Types.Null;\n    } else if ((value instanceof String) || (typeof value === 'string')) {\n      return Cell.Types.String;\n    } else if (typeof value === 'number') {\n      return Cell.Types.Number;\n    } else if (typeof value === 'boolean') {\n      return Cell.Types.Boolean;\n    } else if (value instanceof Date) {\n      return Cell.Types.Date;\n    } else if (value.text && value.hyperlink) {\n      return Cell.Types.Hyperlink;\n    } else if (value.formula || value.sharedFormula) {\n      return Cell.Types.Formula;\n    } else if (value.richText) {\n      return Cell.Types.RichText;\n    } else if (value.sharedString) {\n      return Cell.Types.SharedString;\n    } else if (value.error) {\n      return Cell.Types.Error;\n    }\n    return Cell.Types.JSON;\n  },\n\n  // map valueType to constructor\n  types: [\n    {t: Cell.Types.Null, f: NullValue},\n    {t: Cell.Types.Number, f: NumberValue},\n    {t: Cell.Types.String, f: StringValue},\n    {t: Cell.Types.Date, f: DateValue},\n    {t: Cell.Types.Hyperlink, f: HyperlinkValue},\n    {t: Cell.Types.Formula, f: FormulaValue},\n    {t: Cell.Types.Merge, f: MergeValue},\n    {t: Cell.Types.JSON, f: JSONValue},\n    {t: Cell.Types.SharedString, f: SharedStringValue},\n    {t: Cell.Types.RichText, f: RichTextValue},\n    {t: Cell.Types.Boolean, f: BooleanValue},\n    {t: Cell.Types.Error, f: ErrorValue},\n  ].reduce((p, t) => { p[t.t] = t.f; return p; }, []),\n\n  create: function(type, cell, value) {\n    var T = this.types[type];\n    if (!T) {\n      throw new Error('Could not create Value of type ' + type);\n    }\n    return new T(cell, value);\n  }\n};\n"]}